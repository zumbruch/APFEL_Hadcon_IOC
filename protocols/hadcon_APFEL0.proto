Terminator  = LF;
LockTimeout  = 5000;
ReplyTimeout  = 4000;
ReadTimeout   = 500;
WriteTimeout  = 3000;
ExtraInput    = Ignore;

# Connect a stringout record to this to get
# a generic command interface.
# After processing finishes, the record contains the reply.

key = "APFEL";
recvKey = "%*{\nRECV|RECV} "$key" ";

dummy 
{
	out "";
}

setDac {
#Example of command field(OUT, "@$(protocolFile) setDac($(DAC),$(chipId),$(pinSetIndex),$(sideSelect),$(port)) $(device)") 

	Terminator  = LF;
	cc="9";
	dummy;
	out $key" "$cc" %x \$1 \$2 \$3 \$4 \$5";	
}

readDac {
#Example of command field(INP, "@$(protocolFile) readDac($(DAC),$(chipId),$(pinSetIndex),$(sideSelect),$(port)) $(device)") 

    ExtraInput = Ignore;
	Terminator  = LF;
	cc="A";
	ic="dac";

	dummy; 
	out $key" "$cc" %x \$1 \$2 \$3 \$4 \$5 0";	
   
	in $recvKey" "$ic" port:%(\$5)#{A=1|B=2|C=3|D=4|E=5|F=6|G=7} pinSet:\$3 side:\$4 chip:\$2 dac:\$1 %x";	
}

autoCalibration {
#Example of command field(OUT, "@$(protocolFile) autoCalibration($(chipId),$(pinSetIndex),$(sideSelect),$(port)) $(device)") 

	Terminator = LF;
	cc="B";
	dummy;
	out $key" "$cc" \$1 \$2 \$3 \$4";	
}

genAutoCalibration {
#Example of command field(OUT, "@$(protocolFile) genAutoCalibration $(device)") 
#requieres calc(out) record

	Terminator = LF;
	cc="B";
	dummy;
	out $key" "$cc" %(A)x %(B)x %(C)x %(D)#{A=1|B=2|C=3|D=4|E=5|F=6|G=7}";	
}

testPulse {
#Example of command field(OUT, "@$(protocolFile) testPulse($(chipId),$(pinSetIndex),$(sideSelect),$(port)) $(device)") 

	Terminator = LF;
	cc="C";
	dummy;
	out $key" "$cc" %x \$1 \$2 \$3 \$4";	
}

testPulseSeq {
#Example of command field(OUT, "@$(protocolFile) testPulseSeq($(channel),$(chipId),$(pinSetIndex),$(sideSelect),$(port)) $(device)") 

	Terminator = LF;
	cc="D";
	dummy;
	out $key" "$cc" %x \$1 \$2 \$3 \$4 \$5";	
}

setAmplification {
#Example of command field(OUT, "@$(protocolFile) setAmplification($(chipId),$(pinSetIndex),$(sideSelect),$(port)) $(device)") 

	Terminator = LF;
	cc="E";
	dummy;
	out $key" "$cc" %x \$1 \$2 \$3 \$4";	
}

resetAmplification {
#Example of command field(OUT, "@$(protocolFile) resetAmplification($(chipId),$(pinSetIndex),$(sideSelect),$(port)) $(device)") 

	Terminator = LF;
	cc="F";
	dummy;
	out $key" "$cc" %x \$1 \$2 \$3 \$4";	
}

listId {
#Example of command field(OUT, "@$(protocolFile) listId($(nChannels)) $(device)") 

	Terminator = LF;
	cc="10";
	dummy;
	out $key" "$cc" 1 \$1";	
}

listIdStatus_intr {
#Example of command field(INP, "@$(protocolFile) listIdStatus($(chipId),$(pinSetIndex),$(sideSelect),$(port)) $(device)") 

	Terminator = LF;
	ic="list";
	in $key" "$cc" port:\$4 pinSet:\$2 side:\$3 chip:\$1 %{no|yes}";	
}


setTrigger {
#Example of command field(OUT, "@$(protocolFile) setTrigger $(device)") 
#    requieres calc(out) record

	Terminator = LF;
	cc="11";
	dummy;
	out $key" "$cc" %(A){OFF|ON} %(B)#{A=1|B=2|C=3|D=4|E=5|F=6|G=7} %(C)x";  	
}

requestTrigger {
#Example of command field(OUT, "@$(protocolFile) requestTrigger $(device)") 
#    requieres calc(out) record

	Terminator = LF;
	cc="11";
	dummy;
	out $key" "$cc;	
}

readTrigger_intr {
#Example of command field(OUT, "@$(protocolFile) readTrigger_intr $(device)") 
#    requieres calc(out) record

	Terminator = LF;
	ic="trigger";
	in $recvKey" "$ic" %(A){OFF|ON} %(B)#{A=1|B=2|C=3|D=4|E=5|F=6|G=7} %(C)x";
}

readTrigger {
#Example of command field(OUT, "@$(protocolFile) readTrigger $(device)") 
#    requieres calc(out) record

	Terminator = LF;
	requestTrigger;
	readTrigger_intr;
}




